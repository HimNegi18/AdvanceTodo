import { useQuery, useMutation, useQueryClient } from \'@tanstack/react-query\';\nimport api from \'@/lib/api\';\nimport { Priority } from \'@prisma/client\'; // Assuming you\'ll copy this enum to frontend types\n\n// Define Todo types - should match your backend Prisma schema and DTOs\ninterface Todo {\n  id: string;\n  title: string;\n  description?: string;\n  completed: boolean;\n  dueDate?: string; // ISO 8601 string\n  priority: Priority;\n  tags?: string; // Comma-separated string\n  createdAt: string;\n  updatedAt: string;\n  userId: string;\n}\n\ninterface CreateTodoDto {\n  title: string;\n  description?: string;\n  dueDate?: string;\n  priority?: Priority;\n  tags?: string;\n}\n\ninterface UpdateTodoDto {\n  title?: string;\n  description?: string;\n  completed?: boolean;\n  dueDate?: string;\n  priority?: Priority;\n  tags?: string;\n}\n\ninterface TodoQueryParams {\n  search?: string;\n  status?: boolean;\n  tag?: string;\n  priority?: string;\n}\n\nexport function useTodos(params?: TodoQueryParams) {\n  return useQuery<Todo[], Error>({\n    queryKey: [\'todos\', params],\n    queryFn: async () => {\n      const { data } = await api.get<\'Todo[]\'>(\'/todos\', { params });\n      return data as Todo[];\n    },\n  });\n}\n\nexport function useTodo(id: string) {\n  return useQuery<Todo, Error>({\n    queryKey: [\'todo\', id],\n    queryFn: async () => {\n      const { data } = await api.get<\'Todo\'>(\`/todos/${id}\`);\n      return data as Todo;\n    },\n  });\n}\n\nexport function useCreateTodo() {\n  const queryClient = useQueryClient();\n  return useMutation<Todo, Error, CreateTodoDto>({\n    mutationFn: async (newTodo) => {\n      const { data } = await api.post<\'Todo\'>(\'/todos\', newTodo);\n      return data as Todo;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\'todos\'] });\n    },\n  });\n}\n\nexport function useCreateNaturalLanguageTodo() {\n  const queryClient = useQueryClient();\n  return useMutation<Todo, Error, { text: string }>({\n    mutationFn: async (payload) => {\n      const { data } = await api.post<\'Todo\'>(\'/todos/natural-language\', payload);\n      return data as Todo;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\'todos\'] });\n    },\n  });\n}\n\nexport function useUpdateTodo() {\n  const queryClient = useQueryClient();\n  return useMutation<Todo, Error, { id: string; updates: UpdateTodoDto }>({\n    mutationFn: async ({ id, updates }) => {\n      const { data } = await api.patch<\'Todo\'>(\`/todos/${id}\`, updates);\n      return data as Todo;\n    },\n    onSuccess: (_, { id }) => {\n      queryClient.invalidateQueries({ queryKey: [\'todos\'] });\n      queryClient.invalidateQueries({ queryKey: [\'todo\', id] });\n    },\n  });\n}\n\nexport function useToggleTodoCompletion() {\n  const queryClient = useQueryClient();\n  return useMutation<Todo, Error, string>({\n    mutationFn: async (id) => {\n      const { data } = await api.patch<\'Todo\'>(\`/todos/${id}/complete\`);\n      return data as Todo;\n    },\n    onSuccess: (_, id) => {\n      queryClient.invalidateQueries({ queryKey: [\'todos\'] });\n      queryClient.invalidateQueries({ queryKey: [\'todo\', id] });\n    },\n  });\n}\n\nexport function useDeleteTodo() {\n  const queryClient = useQueryClient();\n  return useMutation<void, Error, string>({\n    mutationFn: async (id) => {\n      await api.delete(\`/todos/${id}\`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\'todos\'] });\n    },\n  });\n}\n